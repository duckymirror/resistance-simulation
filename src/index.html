<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Resistance simulation</title>
    <script src="js/require.js"></script>
    <script>
        require.config({
            baseUrl: './',
            packages: [
                {
                    name: 'physicsjs',
                    location: 'js',
                    main: 'physicsjs'
                }
            ]
        });
    </script>
    <script>
        require([
            'physicsjs',
            'physicsjs/renderers/canvas',
            'physicsjs/bodies/circle'
        ], function (Physics) {
            Physics({
                integrator: 'verlet'
            }, function (world) {
                var electrons = [];

                function updateElectrons() {
                    for (let i in electrons) {
                        let electron = electrons[i];
                        if (electron.x > 800 + electron.radius) {
                            world.remove(electron);
                            electrons.splice(i, 1);
                        }
                    }

                    if (Math.random() < 0.1) {
                        let electron = Physics.body('circle', {
                            x: 0,
                            y: Math.random() * 400,
                            vx: 1,
                            radius: 5
                        });
                        world.add(electron);
                        electrons.push(electron);
                    }
                }

                var renderer = Physics.renderer('canvas', {
                    el: 'viewport',
                    /*width: 800,
                    height: 400*/
                });
                world.add(renderer);

                world.on('step', function () {
                    world.render();
                });

                Physics.util.ticker.on(function (time) {
                    updateElectrons(Physics, world);
                    world.step(time);
                });
            });
        });
    </script>
</head>
<body>
    <div id="viewport" style="height: 400px; width: 800px;">
    </div>
</body>
</html>